<HTML>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created on June, 9  2008 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>APRON 0.9.8: Environments</TITLE>

<META NAME="description" CONTENT="APRON 0.9.8: Environments">
<META NAME="keywords" CONTENT="APRON 0.9.8: Environments">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC92"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_55.html#SEC91"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_57.html#SEC93"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_54.html#SEC90"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_54.html#SEC90"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_104.html#SEC140"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<HR SIZE=1>
<H2> Environments (<TT>`ap_environment.h'</TT>) </H2>
<!--docid::SEC92::-->
<P>

Environments bind variables (of level 1) to dimensions (of level 0).
</P><P>

<A NAME="IDX110"></A>
<DL>
<DT><U>datatype:</U> <B>ap_environment_t</B>
<DD>Internal datatype for environments.
</P><P>

For information, the definition is:
<TABLE><tr><td>&nbsp;</td><td class=example><pre>typedef struct ap_environment_t {
  ap_var_t* var_of_dim;
  /*
    Array of size intdim+realdim, indexed by dimensions.
    - It should not contain identical strings..
    - Slice [0..intdim-1] is lexicographically sorted,
      and denotes integer variables.
    - Slice [intdim..intdim+realdim-1] is lexicographically sorted,
      and denotes real variables.
    - The memory allocated for the variables are attached to the structure
      (they are freed when the structure is no longer in use)
  */
  size_t intdim; /* Number of integer variables */
  size_t realdim;/* Number of real variables */
  size_t count; /* For reference counting */
} ap_environment_t;
</pre></td></tr></table></DL>
</P><P>

<A NAME="IDX111"></A>
<DL>
<DT><U>Function:</U> void <B>ap_environment_free</B> <I>(ap_environment_t* <VAR>env</VAR>)</I>
<DD><A NAME="IDX112"></A>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_copy</B> <I>(ap_environment_t* <VAR>env</VAR>)</I>
<DD>Respectively free and duplicate an environment.
</P><P>

(<CODE>copy</CODE> is cheap, as environments are managed with reference
counters).
</DL>
</P><P>

<A NAME="IDX113"></A>
<DL>
<DT><U>Function:</U> void <B>ap_environment_fdump</B> <I>(FILE* <VAR>stream</VAR>, ap_environment_t* <VAR>env</VAR>)</I>
<DD>Print an environment under the form:
<TABLE><tr><td>&nbsp;</td><td class=example><pre>  environment: dim = (..,..), count = ..
  0: name0
  1: name1
  ...
</pre></td></tr></table></DL>
</P><P>

<A NAME="IDX114"></A>
<DL>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_alloc_empty</B> <I>()</I>
<DD>Build an empty environment.
</DL>
</P><P>

<A NAME="IDX115"></A>
<DL>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_alloc</B> <I>(ap_var_t* <VAR>var_of_intdim</VAR>, size_t <VAR>intdim</VAR>, ap_var_t* <VAR>var_of_realdim</VAR>, size_t <VAR>realdim</VAR>)</I>
<DD>Build an environment from an array of integer and an array of real variables.
</P><P>

<VAR>var_of_intdim</VAR> is an array of variables of size <VAR>intdim</VAR>,
<VAR>var_of_realdim</VAR> is an array of variables of size
<VAR>realdim</VAR>. Pointers to arrays may be <CODE>NULL</CODE> if their size is
0.
</P><P>

Variables are duplicated in the result, so it is the responsability of
the user to free the variables he provides.
</P><P>

If some variables are duplicated, return <CODE>NULL</CODE>.
</DL>
</P><P>

<A NAME="IDX116"></A>
<DL>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_add</B> <I>(ap_environment_t* <VAR>env</VAR>, ap_var_t* <VAR>var_of_intdim</VAR>, size_t <VAR>intdim</VAR>, ap_var_t* <VAR>var_of_realdim</VAR>, size_t <VAR>realdim</VAR>)</I>
<DD><A NAME="IDX117"></A>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_remove</B> <I>(ap_environment_t* <VAR>env</VAR>, ap_var_t* <VAR>tvar</VAR>, size_t <VAR>size</VAR>)</I>
<DD>Resp. add or remove new variables to an existing environment, with
a functional semantics. Same conventions as for
<CODE>ap_environment_alloc</CODE> function apply. If the result is
non-sense (or in case of attempt to remove an unknwon variable),
return <CODE>NULL</CODE>.
</DL>
</P><P>

<A NAME="IDX118"></A>
<DL>
<DT><U>Function:</U> ap_dim_t <B>ap_environment_dim_of_var</B> <I>(ap_environment_t* <VAR>env</VAR>, ap_var_t <VAR>var</VAR>)</I>
<DD>Convert a variable in its corresponding dimension in the environment <VAR>env</VAR>. If <VAR>var</VAR> is unknown in <VAR>env</VAR>, return <CODE>AP_DIM_MAX</CODE>.
</DL>
<A NAME="IDX119"></A>
<DL>
<DT><U>Function:</U> ap_dim_t <B>ap_environment_var_of_dim</B> <I>(ap_environment_t* <VAR>env</VAR>, ap_dim_t <VAR>dim</VAR>)</I>
<DD>Return the variable associated to the dimension <VAR>dim</VAR> in the environment <VAR>env</VAR>. There is no bound check here.
</DL>
</P><P>

The remaining functions are much less useful for normal user.
</P><P>

<A NAME="IDX120"></A>
<DL>
<DT><U>Function:</U> bool <B>ap_environment_is_eq</B> <I>(ap_environment_t* <VAR>env1</VAR>, ap_environment_t* <VAR>env2</VAR>)</I>
<DD><A NAME="IDX121"></A>
<DT><U>Function:</U> bool <B>ap_environment_is_leq</B> <I>(ap_environment_t* <VAR>env1</VAR>, ap_environment_t* <VAR>env2</VAR>)</I>
<DD>Resp. test the equality and the inclusion of two environments.
</DL>
<A NAME="IDX122"></A>
<DL>
<DT><U>Function:</U> int <B>ap_environment_compare</B> <I>(ap_environment_t* <VAR>env1</VAR>, ap_environment_t* <VAR>env2</VAR>)</I>
<DD>Return:
<DL COMPACT>
<DT><CODE>-2</CODE>
<DD>if the environments are not compatible (a variable has a different
type in the 2 environments);
<DT><CODE>-1</CODE>
<DD>if <VAR>env1</VAR> is a subset of (included in) <VAR>env2</VAR>;
<DT><CODE>0</CODE>
<DD>if they are equal;
<DT><CODE>+1</CODE>
<DD>if <VAR>env1</VAR> is a superset of <VAR>env2</VAR>;
<DT><CODE>+2</CODE>
<DD>otherwise: the least common environment exists and is a strict
superset of both environments.
</DL>
</DL>
<A NAME="IDX123"></A>
<DL>
<DT><U>Function:</U> int <B>ap_environment_hash</B> <I>(ap_environment_t* <VAR>env</VAR>)</I>
<DD>Return an hash code for an environment.
</DL>
<P>

<A NAME="IDX124"></A>
<DL>
<DT><U>Function:</U> ap_dimchange_t* <B>ap_environment_dimchange</B> <I>(ap_environment_t* <VAR>env1</VAR>, ap_environment_t* <VAR>env</VAR>)</I>
<DD>Compute the transformation for converting from an environment
<VAR>env1</VAR> to a superenvironment <VAR>env</VAR>.  Return NULL if <VAR>env</VAR>
is not a superenvironment.
</DL>
</P><P>

<A NAME="IDX125"></A>
<DL>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_lce</B> <I>(ap_environment_t* <VAR>env1</VAR>, ap_environment_t* <VAR>env2</VAR>, ap_dimchange_t** <VAR>dimchange1</VAR>, ap_dimchange_t** <VAR>dimchange2</VAR>)</I>
<DD>Least common environment to two enviroenments.
<UL>
<LI>
Assume <CODE>ap_environment_is_eq(env1,env2)==false</CODE>
<LI>
If environments are not compatible (a variable has different types in
the 2 environments), return NULL
<LI>
Compute also in <VAR>dimchange1</VAR> and <VAR>dimchange2</VAR> the conversion transformations to the lce.
<LI>
If no dimensions to add to <VAR>env1</VAR>, this implies that <VAR>env</VAR> is
actually <VAR>env1</VAR>. In this case,
<CODE>*dimchange1==NULL</CODE>. Otherwise, the function allocates the
<CODE>*dimchange1</CODE> with <CODE>ap_dimchange_alloc</CODE>.
</UL>
</DL>
<P>

<A NAME="IDX126"></A>
<DL>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_lce_array</B> <I>(ap_environment_t** <VAR>tenv</VAR>, size_t <VAR>size</VAR>, ap_dimchange_t*** <VAR>ptdimchange</VAR>)</I>
<DD>Least common environment to an array of environments.
<UL>
<LI>
Assume the size <VAR>size</VAR> of the array <VAR>tenv</VAR> is at least one;
<LI>
If all input environments are the same, <CODE>*ptdimchange==NULL</CODE>.
Otherwise, compute in <CODE>*ptdimchange</CODE> the conversion permutations
<LI>
If no dimensions to add to <CODE>tenv[i]</CODE>, this implies that the
result is actually <CODE>tenv[i]</CODE>. In this case,
<CODE>(*ptdimchange)[i]==NULL</CODE>. Otherwise, the function allocates the
<CODE>(*ptdimchange)[i]</CODE> with <CODE>ap_dimchange_alloc</CODE>.
</UL>
</DL>
<P>

<A NAME="IDX127"></A>
<DL>
<DT><U>Function:</U> ap_environment_t* <B>ap_environment_rename</B> <I>(ap_environment_t* <VAR>env</VAR>, ap_var_t* <VAR>tvar1</VAR>, ap_var_t* <VAR>tvar2</VAR>, size_t <VAR>size</VAR>, ap_dimperm_t* <VAR>perm</VAR>)</I>
<DD>Rename the variables in the environment.  <VAR>size</VAR> is the common
size of arrays <VAR>tvar1</VAR> and <VAR>tvar2</VAR>, and <VAR>perm</VAR> is a
result-parameter pointing to an <EM>existing but not initialized</EM>
object of type <CODE>ap_dimperm_t</CODE>.
</P><P>

The function applies the variable substitution <CODE>tvar1[i]-&#62;tvar2[i]</CODE>
to the environment, and returns the resulting environment and the
allocated transformation permutation in <CODE>*perm</CODE>.
</P><P>

If the parameters are not valid, return <CODE>NULL</CODE> with
<CODE>perm-&#62;dim==NULL</CODE>.
</DL>
</P><P>

<A NAME="Linear expressions of level 1"></A>
<HR SIZE=1>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_55.html#SEC91"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_57.html#SEC93"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_54.html#SEC90"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_54.html#SEC90"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_104.html#SEC140"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="apron_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated
on <I>June, 9  2008</I>
using <A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
